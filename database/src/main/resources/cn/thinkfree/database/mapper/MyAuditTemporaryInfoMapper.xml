<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.thinkfree.database.mapper.PcAuditTemporaryInfoMapper">

    <sql id="My_Base_Column_List">
        b.id, b.company_id, b.company_name, b.role_id, b.province_code, b.address, b.legal_name, b.legal_phone,
        b.legal_id_card, b.business_code, b.organization_code, b.tax_code, b.is_check, b.create_time,
        b.phone, b.business_photo_url, b.work_photo_url, b.deposit_money, b.lbs, b.is_delete, b.city_code,
        b.area_code, b.telephone, b.content, b.audit_status, b.lefal_card_up_url, b.lefal_card_down_url,
        b.work_card_from, b.work_card_indate, b.update_time, b.work_code, b.company_classify, b.site_company_id,
        b.business_type, b.platform_type, b.register_province_code, b.register_city_code, b.register_area_code,
        b.register_address, b.postcode, b.email, b.company_type, b.unify_social_credit_code, b.official_seal_url,
        b.is_three_to_one, b.tax_code_photo_url, b.contact_name, b.contact_phone, b.is_taxpayer, b.comapny_nature,
        b.change_status, b.change_date, b.account_province, b.account_city, b.account_district, b.account_name,
        b.card_name, b.account_branch_name, b.account_number, b.license_url, b.account_area, b.account_type,
        b.taxpayer_registration_number
    </sql>
    <select id="findCompanyTemporaryInfo" parameterType="java.lang.String" resultMap="BaseResultMap">
    SELECT
        <include refid="My_Base_Column_List" />
    FROM
        pc_audit_temporary_info b
        JOIN ( SELECT MAX ( change_date ) change_date, company_id
        FROM pc_audit_temporary_info GROUP BY company_id ) d
        ON d.company_id = b.company_id
        AND b.change_date = d.change_date
    WHERE
        b.company_id = #{companyId}

    </select>
</mapper>